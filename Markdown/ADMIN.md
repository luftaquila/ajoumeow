관리자 사용설명서
====================

전산망 관리자를 위한 관리자 메뉴 사용설명서입니다.

## 1. 관리자 권한

* 시스템상 급식표에서 이미 지난 날짜의 셀에는 접근할 수 없으나, 관리자 모드는 이를 무시하고 모든 셀의 편집 권한을 갖습니다.  
* 관리자 모드는 [입력 필터링 조건](https://github.com/luftaquila/ajoumeow/blob/master/Markdown/MANUAL.md#-%EC%9E%85%EB%A0%A5-%ED%95%84%ED%84%B0%EB%A7%81) 에 따른 유효성 검사를 모두 우회하고 데이터를 서버로 바로 전송합니다.  
따라서, 관리자 모드 이용시 서버 데이터베이스의 데이터 무결성 유지에 각별히 유의하여 주십시오.  
주요 규칙은 입력 필터링 조건과 동일하며 다음과 같습니다.
  * 데이터 문자열의 맨 앞과 맨 끝에 공백이 존재해서는 안 됩니다.
  * 문자열은 콤마(,)를 포함할 수 없습니다.  

* 관리자 모드로 전환하는 방법은 다음과 같습니다.
  1. 급식표에서 `날씨 아이콘`을 클릭하면 관리자 인증 팝업이 표시됩니다.  
  1. 관리자 비밀번호를 입력하면 날짜 표시란 텍스트가 *관리자 모드* 로 변경됩니다.

## 2. 급식 인증
[미유미유 메인 페이지](https://luftaquila.github.io/ajoumeow)에서 하단의 `Calc` 메뉴를 누르면 급식인증기 페이지로 이동합니다.  
인증기 링크를 급식인증방에 공지로 입력해 두면 편리합니다.  
급식 인증기에서 인증한 데이터는 스프레드시트의 `Receiver` 시트에 기록됩니다.

접속 시 관리자 인증 창이 표시됩니다. 관리자 비밀번호를 입력하십시오.  
인증에 5회 실패할 경우 미유미유 메인 페이지로 이동합니다.

* 급식 인증
  1. 날짜 선택 필드에서 날짜를 선택하면 해당일의 급식 신청자가 모두 표시됩니다.
  1. **급식인증방에 인증한 회원만** 체크박스에 체크합니다.
  1. 급식표에 이름이 없을 경우 리스트에 이름이 표시되지 않습니다.
      * 급식 인증에 이름이 있으나 표시되지 않을 경우 `+ 추가` 버튼을 이용하여 목록에 추가하십시오.
      * `+ 추가` 버튼을 누를 때마다 입력 필드가 한 줄씩 생성됩니다. 이름과 코스를 맞게 입력합니다.
  1. 시험기간 등 추가로 마일리지를 지급할 경우 `마일리지 할증` 에 체크합니다.
  1. `Confirm` 버튼을 눌러 데이터를 전송합니다.
      * 평일 2인 이상은 1점, 평일 1인 및 주말 2인 이상은 1.5점, 주말 1인은 2점이 지급됩니다.
      * 할증 지급의 경우 1점 -> 1.5점, 1.5점 -> 2점, 2점 -> 3점으로 상향 지급됩니다.

* 기타 인증  
동아리박람회나 동물보호센터 봉사활동 등 별도 마일리지 지급이 필요할 때 이용합니다.
  1. 날짜 선택 필드에서 마일리지를 지급할 활동의 날짜를 선택합니다.
  1. `+ 추가` 버튼을 누를 때마다 입력 필드가 한 줄씩 생성됩니다.
  1. 지급 대상자와 지급할 점수, 지급 사유를 입력합니다.
      * 입력 필드가 2개 이상일 경우 `> 지급 사유 통일하기` 버튼이 활성화됩니다.
      * 클릭 시 자동으로 모든 필드의 지급 사유를 맨 위 필드의 지급 사유로 채워넣습니다.
  1. `Confirm` 버튼을 눌러 데이터를 전송합니다.
  
* 인증 삭제  
이미 인증 완료한 내역을 취소할 때 이용합니다.
  1. 날짜 선택 필드에서 날짜를 선택하면 해당일에 활동을 인증했던 급식자가 모두 표시됩니다.
  1. **인증을 취소할 회원만** 체크박스가 체크되도록 합니다.
  1. `Confirm` 버튼을 눌러 데이터를 전송하고 인증 내역을 삭제합니다.

### ✔ 주의사항
* 급식 인증은 반드시 급식 인증 메뉴로 인증해야 합니다.  
기타 인증 메뉴로 인증하면 급식 마일리지 및 봉사활동 확인서에서 누락됩니다.

* 되도록 하루치 급식 인증은 한 번에 하는 것을 권장합니다.
  * 불가피하게 따로 인증할 경우에도, 반드시 한 코스의 급식자는 한 번에 인증해야 합니다.
  * 동일 코스의 급식자를 따로 인증하면 2인이 아닌 1인 급식으로 점수가 잘못 지급됩니다.
  
### 입력 유효성 검사
일부 데이터를 입력하지 않으면 데이터를 전송하지 않으며, 상단 상태 표시줄에 오류 정보를 표시합니다.
1. `ERR_WRONG_DATE`  
날짜를 선택하지 않았거나 데이터가 올바르지 않은 경우
1. `ERR_NO_PAYLOAD`  
체크박스에 체크한 항목이 단 한 개도 존재하지 않을 경우
1. `ERR_INVALID_PAYLOAD`  
체크된 항목 중 비어있는 입력 필드가 한 개라도 존재할 경우
    

### 기능 안내
  * [Reload]() 버튼을 누르면 신청자 정보 및 인증 내역을 다시 로드합니다.
  * [Home]() 버튼을 누르면 메인 페이지로 이동합니다.
  * [Sheet]() 버튼을 누르면 데이터베이스 스프레드시트로 이동합니다.
  * *마지막 인증 날짜* 는 `Receiver` 시트의 마지막 셀의 날짜를 표시합니다.

인증기 동작 알고리즘은 [calculator.js](https://github.com/luftaquila/ajoumeow/tree/master/calculator/README.md) 문서를 확인하세요.

## 3. 구글 스프레드시트 데이터베이스
메인 페이지에서 [Sheet](https://docs.google.com/spreadsheets/d/1tubdLyELoYAPi8f3PVeh6jfIbQiQ3au3frIVEbnj20A/edit?usp=sharing)를 눌러 구글 스프레드시트로 이동합니다.  
<br>
시트 편집 권한이 필요한 경우 기존 임원진에게 요청하십시오.  
임원 인수인계 시 기존 임원은 차기 임원을 편집 권한 보유자에 추가해야 합니다.  
불가피하게 편집 권한 요청이 어려운 경우 시트 최초 생성자에게 요청하세요.  
연락처는 [사용설명서](https://github.com/luftaquila/ajoumeow/blob/master/Markdown/MANUAL.md#-%EC%9E%85%EB%A0%A5-%ED%95%84%ED%84%B0%EB%A7%81) 최상단에 있습니다.
<br>

`Record`, `Receiver`, `Edit Log`, `Statistics`, `NameList`, `1365`, `Schedule` 시트가 있습니다.  
* `Record` 시트는 급식 신청 내역을 기록하는 시트입니다.
* `Receiver` 시트는 마일리지 인증 내역을 기록하는 시트입니다.
* `Edit Log` 시트는 급식 수정 및 삭제 내역을 기록하는 시트입니다.
* `Statistics` 시트는 마일리지 현황을 표시하는 시트입니다.
* `NameList` 시트는 회원 목록을 표시합니다.
* `1365` 시트는 1365에 제출할 봉사활동 확인서 문서를 생성합니다.
* `Schedule` 시트는 급식표에 표시될 일정을 관리합니다.

### ✔ 시트 데이터 설정
* `Statistics` 시트의 학기 기간은 수동으로 설정해야 합니다.
  + **G2** 셀에서 이번 학기 시작일을 선택합니다. 셀을 더블 클릭하면 달력이 표시됩니다.
  + **J2** 셀에서 이번 학기 종료일을 선택합니다.
  + **M2** 셀에서 지난 학기 시작일을 선택합니다.
  + **N2** 셀에서 지난 학기 종료일을 선택합니다.
  
<br>

* `1365` 시트의 연도와 월, 참조 명단 데이터는 수동으로 설정해야 합니다.
  1. 1365 아이디 및 생년월일을 표시하기 위한 참조 명단 데이터가 있는 시트의 이름을 **AE1** 셀에 입력합니다.
  1. 확인서를 생성할 연/월 데이터를 **A1** 셀과 **C1** 셀에 입력합니다.
  1. 변경 사항이 *저장 중...* 에서 *드라이브에서 모든 변경사항이 저장되었습니다.* 로 바뀔 때까지 기다립니다.
  1. **AK1** 셀의 새로고침 아이콘을 누르면 입력한 정보를 바탕으로 문서를 생성합니다.  
  생성에는 약 2분 가량 소요됩니다.
  
<br>

* 동아리 행사 등이 있는 경우, 급식표에 일정이 표시되도록 할 수 있습니다.  
  ![example](/Resources/Images/example.png)  
  
  1. `Schedule` 시트의 맨 끝에 한 행을 추가합니다.
  1. `날짜` 열에는 월/일(요일) 형식의 날짜 문자열을 입력합니다.  
  월/일은 자릿수 맞추기용 0 없이, 요일은 한 글자만 입력하세요.  
  ex) 5/12(화), 10/1(월)
  1. `일정` 열에는 급식표에서 날짜 대신 표시할 텍스트를 입력합니다.  
  급식표 칸이 넓지 않으므로 4자 이내로 입력하는 것을 권장합니다.
  1. `무지개 여부` 열에는 해당 일정이 무지갯빛으로 반짝일지 여부를 결정합니다.  
  반짝이게 하려면 TRUE를, 아니면 FALSE를 입력하세요.

### ✔ 주의사항
* 시트의 내용을 직접 수정할 때는 반드시 데이터 무결성 유지에 유의하십시오.  
  * `Record`와 `Receiver` 시트의 데이터 영역에 빈 셀이 있어서는 안 됩니다.  
    * 불가피하게 직접 내용을 수정할 경우, [입력 필터링 조건](https://github.com/luftaquila/ajoumeow/blob/master/Markdown/MANUAL.md#-%EC%9E%85%EB%A0%A5-%ED%95%84%ED%84%B0%EB%A7%81)에 위배되지 않도록 하십시오.  
    데이터 문자열의 맨 앞이나 끝에 공백이 존재하거나, 문자열이 콤마(,)를 포함해서는 안 됩니다.
    * 불가피하게 직접 내용을 삭제할 경우, 지울 셀의 내용만 삭제해서는 안 됩니다.  
    반드시 지울 셀을 포함하는 행 전체를 선택하고 우클릭하여 `행 삭제` 기능을 이용해 삭제하십시오.
<br>

* `NameList` 시트의 데이터는 `1365` 시트 문서 생성에 이용됩니다. 열 순서를 변경하지 마십시오.  
기본 순서는 다음과 같습니다.  
  * **단과대학, 학과, 학번, 이름, 전화번호, 생년월일, 1365 아이디, 가입 학기, 직책**
<br>

* `Statistics` 시트의 모든 마일리지 계산은 시트에서 자동으로 수행합니다.
  + **시트의 R ~ BM열은 자동 계산에 사용되는 데이터로, 숨김 처리되어 있습니다.**
  숨김 처리된 열을 포함한 시트의 어떠한 셀이라도 수정해서는 안 되며, 숨김 처리를 해제하지 마십시오.

### ✔ 봉사활동 확인서 생성
`1365` 시트는 봉사활동 확인서를 생성하기 위한 시트입니다.
1. 1365 아이디 및 생년월일을 표시하기 위한 참조 명단 데이터가 있는 시트의 이름을 **AE1** 셀에 입력합니다.
1. 확인서를 생성할 연/월 데이터를 **A1** 셀과 **C1** 셀에 입력합니다.
1. 변경 사항이 *저장 중...* 에서 *드라이브에서 모든 변경사항이 저장되었습니다.* 로 바뀔 때까지 기다립니다.
1. **AK1** 셀의 새로고침 아이콘을 누르면 입력한 정보를 바탕으로 문서를 생성합니다. 생성에는 약 2분 가량 소요됩니다.
    * 2019년 8월 현재까지 모바일에서는 불가능합니다.
1. `파일` - `다른 이름으로 다운로드` - `PDF 문서`를 선택해 PDF 형식으로 다운로드 후 제출합니다.

#### `Statistics` 시트 구조
  * **A ~ B** 열은 이번 달에 **급식 활동** 으로 지급한 마일리지의 총합입니다.
    + 모든 수동 지급 내역은 합산하지 않습니다.
  * **D ~ E** 열은 저번 달에 **급식 활동** 으로 지급한 마일리지의 총합입니다.
    + 모든 수동 지급 내역은 합산하지 않습니다.
  * **G ~ H** 열 *이번 학기 전체 합산* 은 이번 학기에 지급한 **모든** 마일리지의 총합입니다.
    + 봉사활동 등으로 별도 수동 지급한 마일리지까지 모두 합산합니다.
  * **J ~ K** 열 *이번 학기 급식 총합* 은 이번 학기에 **급식 활동** 으로 지급한 마일리지의 총합입니다.
    + 모든 수동 지급 내역은 합산하지 않습니다.
