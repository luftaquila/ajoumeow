관리자 사용설명서
====================

전산망 관리자를 위한 관리자 메뉴 사용설명서입니다.

## 1. 급식표 관리자 권한

규칙상 이미 지난 날짜의 셀은 수정 또는 삭제가 불가능하나,  
관리자 모드에서는 제한이 없으며 입력 유효성 검사를 우회합니다.  
급식 인증기 이용 편의를 위하여 구현한 기능입니다.

1. 급식표에서 `날씨 아이콘`을 클릭하면 관리자 인증 팝업이 표시됩니다.  
1. 비밀번호를 입력하면 날짜 표시란 텍스트가 *관리자 모드* 로 변경됩니다.

## 2. 급식 인증
[미유미유 메인 페이지](https://luftaquila.github.io/ajoumeow)에서 하단의 `Calc` 메뉴를 누르면 급식인증기 페이지로 이동합니다.  
인증기 링크를 급식인증방에 공지로 입력해 두면 편리합니다.  
급식 인증기에서 인증한 데이터는 스프레드시트의 `Receiver` 시트에 기록됩니다.

* 표준 입력
  1. 데이터 로딩이 완료되면 페이지에서 인증을 요구합니다. 관리자 비밀번호를 입력하세요.
  1. 날짜 선택 필드에서 날짜를 선택하면 해당일의 급식 신청자가 모두 표시됩니다.
  1. **급식인증방에 인증한 회원만** 체크박스가 체크되도록 합니다.
  1. 핫타임 기간일 경우 `마일리지 할증` 체크박스를 선택한 후, `Confirm` 버튼을 눌러 전송합니다.
      * 평일 2인 이상은 1점, 평일 1인 및 주말 2인 이상은 1.5점, 주말 1인은 2점이 지급됩니다.
      * 할증이 체크된 경우 1점 -> 1.5점, 1.5점 -> 2점, 2점 -> 3점으로 점수가 상향됩니다.
<br>
* 수동 입력
동아리박람회나 동물보호센터 봉사활동 등 별도 마일리지 지급이 필요할 때 이용합니다.
  1. 마찬가지로 데이터 로딩 후 관리자 비밀번호를 입력합니다.
  1. `수동 입력` 메뉴로 이동합니다.
  1. 지급할 마일리지와 지급 대상자의 이름을 입력하고 제출합니다.

### ✔ 주의사항
* 급식 인증은 반드시 표준 입력 메뉴로 인증해야 합니다.  
수동 입력 메뉴로 지급하면 급식 마일리지 및 봉사활동 확인서에서 누락됩니다.

* 하루치 급식 인증은 한번에 진행하셔야 합니다.  
특히, 한 코스 급식자를 따로따로 인증하면 점수 지급이 1인 급식으로 잘못 지급됩니다.

* 인증할 회원 정보가 인증기에 없으면 표에서 수정하거나 스프레드시트를 직접 수정하고 다시 인증기를 새로고침하세요.  
문서 1번의 관리자 모드를 이용하면 보다 편리하게 수정할 수 있습니다.

### 기능 안내
  * [Mileage Log]() 버튼은 스프레드시트의 `Receiver` 시트를 표시합니다.
  * [Receiver Log]() 버튼은 스프레드시트의 `Record` 시트를 표시합니다.
  * [Reload]() 버튼은 신청자 정보를 다시 로드합니다.
  * [Home]() 버튼을 누르면 신청 페이지로 이동합니다.
  * *마지막 인증 날짜* 는 `Receiver` 시트의 마지막 셀의 날짜를 표시합니다.

인증기 동작 알고리즘은 [calculator.js](https://github.com/luftaquila/ajoumeow/tree/master/calculator/README.md) 문서를 확인하세요.

## 2. 구글 스프레드시트 데이터베이스
[Sheet](https://docs.google.com/spreadsheets/d/1tubdLyELoYAPi8f3PVeh6jfIbQiQ3au3frIVEbnj20A/edit?usp=sharing)를 눌러 데이터베이스로 사용하는 구글 스프레드시트로 이동합니다.
`Record`, `Receiver`, `Edit Log`, `Statistics`, `NameList`, `1365` 시트가  있습니다.

* `Record` 시트는 급식 신청 내역을 기록하는 시트입니다.
* `Receiver` 시트는 마일리지 인증 내역을 기록하는 시트입니다.
* `Edit Log` 시트는 수정 및 삭제 내역을 기록하는 시트입니다.
* `Statistics` 시트는 마일리지 현황을 표시하는 시트입니다.
* `NameList` 시트는 회원 목록을 표시합니다.
* `1365` 시트는 1365에 제출할 봉사활동 확인서 문서를 생성합니다.

### ✔ 시트 데이터 설정
* `Statistics` 시트의 학기 기간은 수동으로 설정해야 합니다.
  + **G2** 셀에서 이번 학기 시작일을 선택합니다. 셀을 선택하면 달력이 표시됩니다.
  + **J2** 셀에서 이번 학기 종료일을 선택합니다.
  + **M2** 셀에서 저번 학기 시작일을 선택합니다.
  + **N2** 셀에서 저번 학기 종료일을 선택합니다.
<br>
* `1365` 시트의 연도와 월, 참조 명단 데이터는 수동으로 설정해야 합니다.
  1. 1365 아이디 및 생년월일을 표시하기 위한 참조 명단 데이터가 있는 시트의 이름을 **AE1** 셀에 입력합니다.
  1. 확인서를 생성할 연/월 데이터를 **A1** 셀과 **C1** 셀에 입력합니다.
  1. 변경 사항이 *저장 중...* 에서 *드라이브에서 모든 변경사항이 저장되었습니다.* 로 바뀔 때까지 기다립니다.
  1. **AK1** 셀의 새로고침 아이콘을 누르면 입력한 정보를 바탕으로 문서를 생성합니다. 생성에는 약 2분 가량 소요됩니다.

### ✔ 주의사항
* `NameList` 시트의 데이터는 `1365` 시트 문서 생성에 이용됩니다. 열 순서를 변경하지 마십시오.  
기본 순서는 다음과 같습니다.  
**단과대학, 학과, 학번, 이름, 전화번호, 생년월일, 1365 아이디, 가입 학기, 직책**
<br>
* `Statistics` 시트의 모든 마일리지 계산은 시트에서 자동으로 수행합니다.
  + **시트의 R ~ BM열은 자동 계산에 사용되는 데이터로, 숨김 처리되어 있습니다.**
  숨김 처리된 열의 어떠한 셀이라도 수정해서는 안 되며, 숨김 처리를 해제하지 마십시오.

### 봉사활동 확인서 생성
`1365` 시트는 봉사활동 확인서를 생성하기 위한 시트입니다.
1. 1365 아이디 및 생년월일을 표시하기 위한 참조 명단 데이터가 있는 시트의 이름을 **AE1** 셀에 입력합니다.
1. 확인서를 생성할 연/월 데이터를 **A1** 셀과 **C1** 셀에 입력합니다.
1. 변경 사항이 *저장 중...* 에서 *드라이브에서 모든 변경사항이 저장되었습니다.* 로 바뀔 때까지 기다립니다.
1. **AK1** 셀의 새로고침 아이콘을 누르면 입력한 정보를 바탕으로 문서를 생성합니다. 생성에는 약 2분 가량 소요됩니다.
1. `파일` - `다른 이름으로 다운로드` - `PDF 문서`를 선택해 PDF 형식으로 다운로드 후 제출합니다.

#### `Statistics` 시트 구조
  * **A ~ B** 열은 이번 달에 **급식 활동** 으로 지급한 마일리지의 총합입니다.
    + 모든 수동 지급 내역은 합산하지 않습니다.
  * **D ~ E** 열은 저번 달에 **급식 활동** 으로 지급한 마일리지의 총합입니다.
    + 모든 수동 지급 내역은 합산하지 않습니다.
  * **G ~ H** 열 *이번 학기 전체 합산* 은 이번 학기에 지급한 **모든** 마일리지의 총합입니다.
    + 봉사활동 등으로 별도 수동 지급한 마일리지까지 모두 합산합니다.
  * **J ~ K** 열 *이번 학기 급식 총합* 은 이번 학기에 **급식 활동** 으로 지급한 마일리지의 총합입니다.
    + 모든 수동 지급 내역은 합산하지 않습니다.
