<html>

<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
  crossorigin="anonymous"></script>
<script>
  var datum;
  function handleOnLoad() {
    $.ajax({
      url: 'https://docs.google.com/spreadsheet/pub?key=1tubdLyELoYAPi8f3PVeh6jfIbQiQ3au3frIVEbnj20A&single=true&gid=850606151&range=G2:I&output=csv',
      type: "GET",
      dataType: 'text',
      cache: false,
      success: function (response) {
        parseCSV(response, '\n', ',');
      }
    });
    setData();
  }

  function parseCSV(text, lineTerminator, cellTerminator) {
    datum = text.split(lineTerminator).map((line) => line.split(cellTerminator));
  }
    /*
    for (var i = 0; i < datum.length; i++) {
      document.write('<br />');
      for (var j = 0; j < datum[i].length; j++) {
        document.write(datum[i][j] + ', ');
      }
    }
    */

    var dateFormat = function () {
    	var	token = /d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,
    		timezone = /\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,
    		timezoneClip = /[^-+\dA-Z]/g,
    		pad = function (val, len) {
    			val = String(val);
    			len = len || 2;
    			while (val.length < len) val = "0" + val;
    			return val;
    		};

    	// Regexes and supporting functions are cached through closure
    	return function (date, mask, utc) {
    		var dF = dateFormat;

    		// You can't provide utc if you skip other args (use the "UTC:" mask prefix)
    		if (arguments.length == 1 && Object.prototype.toString.call(date) == "[object String]" && !/\d/.test(date)) {
    			mask = date;
    			date = undefined;
    		}

    		// Passing date through Date applies Date.parse, if necessary
    		date = date ? new Date(date) : new Date;
    		if (isNaN(date)) throw SyntaxError("invalid date");

    		mask = String(dF.masks[mask] || mask || dF.masks["default"]);

    		// Allow setting the utc argument via the mask
    		if (mask.slice(0, 4) == "UTC:") {
    			mask = mask.slice(4);
    			utc = true;
    		}

    		var	_ = utc ? "getUTC" : "get",
    			d = date[_ + "Date"](),
    			D = date[_ + "Day"](),
    			m = date[_ + "Month"](),
    			y = date[_ + "FullYear"](),
    			H = date[_ + "Hours"](),
    			M = date[_ + "Minutes"](),
    			s = date[_ + "Seconds"](),
    			L = date[_ + "Milliseconds"](),
    			o = utc ? 0 : date.getTimezoneOffset(),
    			flags = {
    				d:    d,
    				dd:   pad(d),
    				ddd:  dF.i18n.dayNames[D],
    				dddd: dF.i18n.dayNames[D + 7],
    				m:    m + 1,
    				mm:   pad(m + 1),
    				mmm:  dF.i18n.monthNames[m],
    				mmmm: dF.i18n.monthNames[m + 12],
    				yy:   String(y).slice(2),
    				yyyy: y,
    				h:    H % 12 || 12,
    				hh:   pad(H % 12 || 12),
    				H:    H,
    				HH:   pad(H),
    				M:    M,
    				MM:   pad(M),
    				s:    s,
    				ss:   pad(s),
    				l:    pad(L, 3),
    				L:    pad(L > 99 ? Math.round(L / 10) : L),
    				t:    H < 12 ? "a"  : "p",
    				tt:   H < 12 ? "am" : "pm",
    				T:    H < 12 ? "A"  : "P",
    				TT:   H < 12 ? "AM" : "PM",
    				Z:    utc ? "UTC" : (String(date).match(timezone) || [""]).pop().replace(timezoneClip, ""),
    				o:    (o > 0 ? "-" : "+") + pad(Math.floor(Math.abs(o) / 60) * 100 + Math.abs(o) % 60, 4),
    				S:    ["th", "st", "nd", "rd"][d % 10 > 3 ? 0 : (d % 100 - d % 10 != 10) * d % 10]
    			};

    		return mask.replace(token, function ($0) {
    			return $0 in flags ? flags[$0] : $0.slice(1, $0.length - 1);
    		});
    	};
    }();

    // Some common format strings
    dateFormat.masks = {
    	"default":      "ddd mmm dd yyyy HH:MM:ss",
    	shortDate:      "m/d/yy",
    	mediumDate:     "mmm d, yyyy",
    	longDate:       "mmmm d, yyyy",
    	fullDate:       "dddd, mmmm d, yyyy",
    	shortTime:      "h:MM TT",
    	mediumTime:     "h:MM:ss TT",
    	longTime:       "h:MM:ss TT Z",
    	isoDate:        "yyyy-mm-dd",
    	isoTime:        "HH:MM:ss",
    	isoDateTime:    "yyyy-mm-dd'T'HH:MM:ss",
    	isoUtcDateTime: "UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"
    };

    // Internationalization strings
    dateFormat.i18n = {
    	dayNames: [
    		"일", "월", "화", "수", "목", "금", "토",
    		"일요일", "월요일", "화요일", "수요일", "목요일", "금요일", "토요일"
    	],
    	monthNames: [
    		"Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec",
    		"January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"
    	]
    };

    // For convenience...
    Date.prototype.format = function (mask, utc) {
    	return dateFormat(this, mask, utc);
    };

  Date.prototype.getWeek = function()
  {
    var calc = new Date(this.getFullYear(), 0, 1);
    return Math.ceil((((this - calc) / 86400000) + calc.getDay() + 1) / 7);
  }

  function yourNameIs(p1, p2, course, rank)
  {
    p1 = (p1 == undefined ? -1 : p1);
    p2 = (p2 == undefined ? 0 : p2);
    course = (course == undefined ? 2 : course);
    rank = (rank == undefined ? 2 : rank);

    var week = new Date().getWeek();
    var year = new Date().getFullYear();

    var result = JSON.stringify(new Date(year, 0, 1 + p2 + ((week + p1) * 7) - new Date(year, 0, (week * 7)).getDay()));

    for (var i = 0; ; i++)
    {
      if (datum[i][1] == '')
        break;

      if(rank == 1)
      {
        if(result == JSON.stringify(datum[i][1]))
        {
          if((course == 1) && (datum[i][2] == "도서관 & 텔동 코스"))
            return datum[i][0];

          else if((course == 2) && (datum[i][2] == "신학 & 성호관 코스"))
            return datum[i][0];
        }
      }

      else
      {
        if(result == JSON.stringify(datum[i][1]))
        {
          if((course == 1) && (datum[i][2] == "도서관 & 텔동 코스"))
          {
            if(result == JSON.stringify(datum[i + 1][1]))
            {
              if((course == 1) && (datum[i + 1][2] == "도서관 & 텔동 코스"))
                return datum[i + 1][0];
            }
          }
          else if((course == 2) && (datum[i][2] == "신학 & 성호관 코스"))
          {
            if(result == JSON.stringify(datum[i + 1][1]))
            {
              if((course == 2) && (datum[i + 1][2] == "신학 & 성호관 코스"))
                return datum[i + 1][0];
            }
          }
        }
      }
    }
  }

  function setData()
  {
    var week = new Date().getWeek();
    var year = new Date().getFullYear();

    document.getElementById("todayDate").innerHTML = new Date().format("m월 d일 dddd");

    document.getElementById("thisWeek_1").innerHTML = new Date(year, 0, 1 + 0 + ((week - 1) * 7) - new Date(year, 0, (week * 7)).getDay()).format("m/d(ddd)");
    document.getElementById("thisWeek_2").innerHTML = new Date(year, 0, 1 + 1 + ((week - 1) * 7) - new Date(year, 0, (week * 7)).getDay()).format("m/d(ddd)");
    document.getElementById("thisWeek_3").innerHTML = new Date(year, 0, 1 + 2 + ((week - 1) * 7) - new Date(year, 0, (week * 7)).getDay()).format("m/d(ddd)");
    document.getElementById("thisWeek_4").innerHTML = new Date(year, 0, 1 + 3 + ((week - 1) * 7) - new Date(year, 0, (week * 7)).getDay()).format("m/d(ddd)");
    document.getElementById("thisWeek_5").innerHTML = new Date(year, 0, 1 + 4 + ((week - 1) * 7) - new Date(year, 0, (week * 7)).getDay()).format("m/d(ddd)");

    document.getElementById("nextWeek_1").innerHTML = new Date(year, 0, 1 + 0 + (week * 7) - new Date(year, 0, (week * 7)).getDay()).format("m/d(ddd)");
    document.getElementById("nextWeek_2").innerHTML = new Date(year, 0, 1 + 1 + (week * 7) - new Date(year, 0, (week * 7)).getDay()).format("m/d(ddd)");
    document.getElementById("nextWeek_3").innerHTML = new Date(year, 0, 1 + 2 + (week * 7) - new Date(year, 0, (week * 7)).getDay()).format("m/d(ddd)");
    document.getElementById("nextWeek_4").innerHTML = new Date(year, 0, 1 + 3 + (week * 7) - new Date(year, 0, (week * 7)).getDay()).format("m/d(ddd)");
    document.getElementById("nextWeek_5").innerHTML = new Date(year, 0, 1 + 4 + (week * 7) - new Date(year, 0, (week * 7)).getDay()).format("m/d(ddd)");

    document.getElementById("nextTwoWeek_1").innerHTML = new Date(year, 0, 1 + 0 + ((week + 1) * 7) - new Date(year, 0, (week * 7)).getDay()).format("m/d(ddd)");
    document.getElementById("nextTwoWeek_2").innerHTML = new Date(year, 0, 1 + 1 + ((week + 1) * 7) - new Date(year, 0, (week * 7)).getDay()).format("m/d(ddd)");
    document.getElementById("nextTwoWeek_3").innerHTML = new Date(year, 0, 1 + 2 + ((week + 1) * 7) - new Date(year, 0, (week * 7)).getDay()).format("m/d(ddd)");
    document.getElementById("nextTwoWeek_4").innerHTML = new Date(year, 0, 1 + 3 + ((week + 1) * 7) - new Date(year, 0, (week * 7)).getDay()).format("m/d(ddd)");
    document.getElementById("nextTwoWeek_5").innerHTML = new Date(year, 0, 1 + 4 + ((week + 1) * 7) - new Date(year, 0, (week * 7)).getDay()).format("m/d(ddd)");


  }
</script>

<body onload="handleOnLoad()">
  <style type="text/css">
  .tg  {border-collapse:collapse;border-spacing:0;border-color:#aaa;margin:0px auto;}
  .tg td{font-family:Arial, sans-serif;font-size:14px;padding:3px 0px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:#aaa;color:#333;background-color:#fff;}
  .tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:3px 0px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:#aaa;color:#fff;background-color:#f38630;}
  .tg .tg-nlqr{font-size:14px;border-color:#000000;text-align:center}
  .tg .tg-uys7{border-color:inherit;text-align:center}
  .tg .tg-mcgq{background-color:#b6d7a8;border-color:inherit;text-align:center}
  .tg .tg-7x2k{background-color:#a4c2f4;border-color:inherit;text-align:center}
  .tg .tg-q5p2{background-color:#b4a7d6;border-color:inherit;text-align:center}
  th.tg-sort-header::-moz-selection { background:transparent; }th.tg-sort-header::selection      { background:transparent; }th.tg-sort-header { cursor:pointer; }table th.tg-sort-header:after {  content:'';  float:right;  margin-top:7px;  border-width:0 4px 4px;  border-style:solid;  border-color:#404040 transparent;  visibility:hidden;  }table th.tg-sort-header:hover:after {  visibility:visible;  }table th.tg-sort-desc:after,table th.tg-sort-asc:after,table th.tg-sort-asc:hover:after {  visibility:visible;  opacity:0.4;  }table th.tg-sort-desc:after {  border-bottom:none;  border-width:4px 4px 0;  }@media screen and (max-width: 767px) {.tg {width: auto !important;}.tg col {width: auto !important;}.tg-wrap {overflow-x: auto;-webkit-overflow-scrolling: touch;margin: auto 0px;}}</style>
  <div class="tg-wrap"><table id="tg-1pp0J" class="tg" style="undefined;table-layout: fixed; width: 501px">
  <colgroup>
  <col style="width: 121px">
  <col style="width: 76px">
  <col style="width: 76px">
  <col style="width: 76px">
  <col style="width: 76px">
  <col style="width: 76px">
  </colgroup>
    <tr>
      <th class="tg-nlqr" colspan="6"><p id="todayDate"></p></th>
    </tr>
    <tr>
      <td class="tg-mcgq">이번 주</td>
      <td class="tg-mcgq"><p id="thisWeek_1"></p></td>
      <td class="tg-mcgq"><p id="thisWeek_2"></p></td>
      <td class="tg-mcgq"><p id="thisWeek_3"></p></td>
      <td class="tg-mcgq"><p id="thisWeek_4"></p></td>
      <td class="tg-mcgq"><p id="thisWeek_5"></p></td>
    </tr>
    <tr>
      <td class="tg-mcgq" rowspan="2">도서관&amp;텔동</td>
      <td class="tg-uys7"><p id="thisWeek_d1_1"></p></td>
      <td class="tg-uys7"><p id="thisWeek_d2_1"></p></td>
      <td class="tg-uys7"><p id="thisWeek_d3_1"></p></td>
      <td class="tg-uys7"><p id="thisWeek_d4_1"></p></td>
      <td class="tg-uys7"><p id="thisWeek_d5_1"></p></td>
    </tr>
    <tr>
      <td class="tg-uys7"><p id="thisWeek_d1_2"></p></td>
      <td class="tg-uys7"><p id="thisWeek_d2_2"></p></td>
      <td class="tg-uys7"><p id="thisWeek_d3_2"></p></td>
      <td class="tg-uys7"><p id="thisWeek_d4_2"></p></td>
      <td class="tg-uys7"><p id="thisWeek_d5_2"></p></td>
    </tr>
    <tr>
      <td class="tg-mcgq" rowspan="2">신학&amp;성호관</td>
      <td class="tg-uys7"><p id="thisWeek_s1_1"></p></td>
      <td class="tg-uys7"><p id="thisWeek_s2_1"></p></td>
      <td class="tg-uys7"><p id="thisWeek_s3_1"></p></td>
      <td class="tg-uys7"><p id="thisWeek_s4_1"></p></td>
      <td class="tg-uys7"><p id="thisWeek_s5_1"></p></td>
    </tr>
    <tr>
    <td class="tg-uys7"><p id="thisWeek_s1_2"></p></td>
    <td class="tg-uys7"><p id="thisWeek_s2_2"></p></td>
    <td class="tg-uys7"><p id="thisWeek_s3_2"></p></td>
    <td class="tg-uys7"><p id="thisWeek_s4_2"></p></td>
    <td class="tg-uys7"><p id="thisWeek_s5_2"></p></td>
    </tr>
    <tr>
      <td class="tg-7x2k">다음 주</td>
      <td class="tg-7x2k"><p id="nextWeek_1"></p></td>
      <td class="tg-7x2k"><p id="nextWeek_2"></p></td>
      <td class="tg-7x2k"><p id="nextWeek_3"></p></td>
      <td class="tg-7x2k"><p id="nextWeek_4"></p></td>
      <td class="tg-7x2k"><p id="nextWeek_5"></p></td>
    </tr>
    <tr>
      <td class="tg-7x2k" rowspan="2">도서관&amp;텔동</td>
      <td class="tg-uys7">라</td>
      <td class="tg-uys7"></td>
      <td class="tg-uys7"></td>
      <td class="tg-uys7"></td>
      <td class="tg-uys7"></td>
    </tr>
    <tr>
      <td class="tg-uys7">마</td>
      <td class="tg-uys7"></td>
      <td class="tg-uys7"></td>
      <td class="tg-uys7"></td>
      <td class="tg-uys7"></td>
    </tr>
    <tr>
      <td class="tg-7x2k" rowspan="2">신학&amp;성호관</td>
      <td class="tg-uys7">바</td>
      <td class="tg-uys7"></td>
      <td class="tg-uys7"></td>
      <td class="tg-uys7"></td>
      <td class="tg-uys7"></td>
    </tr>
    <tr>
      <td class="tg-uys7">사</td>
      <td class="tg-uys7"></td>
      <td class="tg-uys7"></td>
      <td class="tg-uys7"></td>
      <td class="tg-uys7"></td>
    </tr>
    <tr>
      <td class="tg-q5p2">다다음 주</td>
      <td class="tg-q5p2"><p id="nextTwoWeek_1"></p></td>
      <td class="tg-q5p2"><p id="nextTwoWeek_2"></p></td>
      <td class="tg-q5p2"><p id="nextTwoWeek_3"></p></td>
      <td class="tg-q5p2"><p id="nextTwoWeek_4"></p></td>
      <td class="tg-q5p2"><p id="nextTwoWeek_5"></p></td>
    </tr>
    <tr>
      <td class="tg-q5p2" rowspan="2">도서관&amp;텔동</td>
      <td class="tg-uys7">아</td>
      <td class="tg-uys7"></td>
      <td class="tg-uys7"></td>
      <td class="tg-uys7"></td>
      <td class="tg-uys7"></td>
    </tr>
    <tr>
      <td class="tg-uys7">자</td>
      <td class="tg-uys7"></td>
      <td class="tg-uys7"></td>
      <td class="tg-uys7"></td>
      <td class="tg-uys7"></td>
    </tr>
    <tr>
      <td class="tg-q5p2" rowspan="2">신학&amp;성호관</td>
      <td class="tg-uys7">차</td>
      <td class="tg-uys7"></td>
      <td class="tg-uys7"></td>
      <td class="tg-uys7"></td>
      <td class="tg-uys7"></td>
    </tr>
    <tr>
      <td class="tg-uys7">카</td>
      <td class="tg-uys7"></td>
      <td class="tg-uys7"></td>
      <td class="tg-uys7"></td>
      <td class="tg-uys7"></td>
    </tr>
  </table></div>
  <script type="text/javascript" charset="utf-8">var TgTableSort=window.TgTableSort||function(n,t){"use strict";function r(n,t){for(var e=[],o=n.childNodes,i=0;i<o.length;++i){var u=o[i];if("."==t.substring(0,1)){var a=t.substring(1);f(u,a)&&e.push(u)}else u.nodeName.toLowerCase()==t&&e.push(u);var c=r(u,t);e=e.concat(c)}return e}function e(n,t){var e=[],o=r(n,"tr");return o.forEach(function(n){var o=r(n,"td");t>=0&&t<o.length&&e.push(o[t])}),e}function o(n){return n.textContent||n.innerText||""}function i(n){return n.innerHTML||""}function u(n,t){var r=e(n,t);return r.map(o)}function a(n,t){var r=e(n,t);return r.map(i)}function c(n){var t=n.className||"";return t.match(/\S+/g)||[]}function f(n,t){return-1!=c(n).indexOf(t)}function s(n,t){f(n,t)||(n.className+=" "+t)}function d(n,t){if(f(n,t)){var r=c(n),e=r.indexOf(t);r.splice(e,1),n.className=r.join(" ")}}function v(n){d(n,L),d(n,E)}function l(n,t,e){r(n,"."+E).map(v),r(n,"."+L).map(v),e==T?s(t,E):s(t,L)}function g(n){return function(t,r){var e=n*t.str.localeCompare(r.str);return 0==e&&(e=t.index-r.index),e}}function h(n){return function(t,r){var e=+t.str,o=+r.str;return e==o?t.index-r.index:n*(e-o)}}function m(n,t,r){var e=u(n,t),o=e.map(function(n,t){return{str:n,index:t}}),i=e&&-1==e.map(isNaN).indexOf(!0),a=i?h(r):g(r);return o.sort(a),o.map(function(n){return n.index})}function p(n,t,r,o){for(var i=f(o,E)?N:T,u=m(n,r,i),c=0;t>c;++c){var s=e(n,c),d=a(n,c);s.forEach(function(n,t){n.innerHTML=d[u[t]]})}l(n,o,i)}function x(n,t){var r=t.length;t.forEach(function(t,e){t.addEventListener("click",function(){p(n,r,e,t)}),s(t,"tg-sort-header")})}var T=1,N=-1,E="tg-sort-asc",L="tg-sort-desc";return function(t){var e=n.getElementById(t),o=r(e,"tr"),i=o.length>0?r(o[0],"td"):[];0==i.length&&(i=r(o[0],"th"));for(var u=1;u<o.length;++u){var a=r(o[u],"td");if(a.length!=i.length)return}x(e,i)}}(document);document.addEventListener("DOMContentLoaded",function(n){TgTableSort("tg-1pp0J")});</script>

</body>
</html>
